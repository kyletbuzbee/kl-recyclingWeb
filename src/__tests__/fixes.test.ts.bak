import { test, expect } from '@playwright/test';
import { render, screen } from '@testing-library/react';
import React from 'react';
import { PricingItem } from '../../pricing';

/**
 * ========================================================================
 * JEST / REACT TESTING LIBRARY FIX
 * ========================================================================
 */

// Mock PricingCard component for demonstration
const PricingCard = ({ item }: { item: PricingItem }) => (
  <div>
    <h2>{item.name}</h2>
    <p>${item.price} / lb</p>
  </div>
);

describe('PricingCard', () => {
  it('should render the price with the correct unit', () => {
    // FIX: The original test was likely passing the entire PricingData object.
    // The fix is to pass a single PricingItem, which the component expects.
    const mockPricingItem: PricingItem = {
      name: 'Standard',
      price: 100,
      unit: 'lb',
    };

    render(<PricingCard item={mockPricingItem} />);

    // Assertion remains the same, but now it passes with the correct data shape.
    expect(screen.getByText('$100 / lb')).toBeInTheDocument();
  });
});

/**
 * ========================================================================
 * PLAYWRIGHT E2E FIX
 * ========================================================================
 */
test('should navigate to the pricing page and see the heading', async ({ page }) => {
  await page.goto('/pricing');

  // FIX: Instead of a brittle `h1` selector, use a role-based locator.
  // This is more resilient to changes in HTML tags and styling.
  await expect(page.getByRole('heading', { name: /pricing/i })).toBeVisible();
});
